"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return"CORRUPT: "+this.message};this.message=a},invalid:function(a){this.toString=function(){return"INVALID: "+this.message};this.message=a},bug:function(a){this.toString=function(){return"BUG: "+this.message};this.message=a},notReady:function(a){this.toString=function(){return"NOT READY: "+this.message};this.message=a}}};sjcl.cipher.aes=function(h){if(!this._tables[0][0][0]){this._precompute()}var d,c,e,g,l,f=this._tables[0][4],k=this._tables[1],a=h.length,b=1;if(a!==4&&a!==6&&a!==8){throw new sjcl.exception.invalid("invalid aes key size")}this._key=[g=h.slice(0),l=[]];for(d=a;d<4*a+28;d++){e=g[d-1];if(d%a===0||(a===8&&d%a===4)){e=f[e>>>24]<<24^f[e>>16&255]<<16^f[e>>8&255]<<8^f[e&255];if(d%a===0){e=e<<8^e>>>24^b<<24;b=b<<1^(b>>7)*283}}g[d]=g[d-a]^e}for(c=0;d;c++,d--){e=g[c&3?d:d-4];if(d<=4||c<4){l[c]=e}else{l[c]=k[0][f[e>>>24]]^k[1][f[e>>16&255]]^k[2][f[e>>8&255]]^k[3][f[e&255]]}}};sjcl.cipher.aes.prototype={encrypt:function(a){return this._crypt(a,0)},decrypt:function(a){return this._crypt(a,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var j=this._tables[0],q=this._tables[1],h=j[4],n=q[4],g,l,f,k=[],c=[],b,p,m,o,e,a;for(g=0;g<0x100;g++){c[(k[g]=g<<1^(g>>7)*283)^g]=g}for(l=f=0;!h[l];l^=b||1,f=c[f]||1){o=f^f<<1^f<<2^f<<3^f<<4;o=o>>8^o&255^99;h[l]=o;n[o]=l;m=k[p=k[b=k[l]]];a=m*0x1010101^p*0x10001^b*0x101^l*0x1010100;e=k[o]*0x101^o*0x1010100;for(g=0;g<4;g++){j[g][l]=e=e<<24^e>>>8;q[g][o]=a=a<<24^a>>>8}}for(g=0;g<5;g++){j[g]=j[g].slice(0);q[g]=q[g].slice(0)}},_crypt:function(k,n){if(k.length!==4){throw new sjcl.exception.invalid("invalid aes block size")}var y=this._key[n],v=k[0]^y[0],u=k[n?3:1]^y[1],t=k[2]^y[2],s=k[n?1:3]^y[3],w,e,m,x=y.length/4-2,p,o=4,q=[0,0,0,0],r=this._tables[n],j=r[0],h=r[1],g=r[2],f=r[3],l=r[4];for(p=0;p<x;p++){w=j[v>>>24]^h[u>>16&255]^g[t>>8&255]^f[s&255]^y[o];e=j[u>>>24]^h[t>>16&255]^g[s>>8&255]^f[v&255]^y[o+1];m=j[t>>>24]^h[s>>16&255]^g[v>>8&255]^f[u&255]^y[o+2];s=j[s>>>24]^h[v>>16&255]^g[u>>8&255]^f[t&255]^y[o+3];o+=4;v=w;u=e;t=m}for(p=0;p<4;p++){q[n?3&-p:p]=l[v>>>24]<<24^l[u>>16&255]<<16^l[t>>8&255]<<8^l[s&255]^y[o++];w=v;v=u;u=t;t=s;s=w}return q}};sjcl.bitArray={bitSlice:function(b,c,d){b=sjcl.bitArray._shiftRight(b.slice(c/32),32-(c&31)).slice(1);return(d===undefined)?b:sjcl.bitArray.clamp(b,d-c)},extract:function(c,d,f){var b,e=Math.floor((-d-f)&31);if((d+f-1^d)&-32){b=(c[d/32|0]<<(32-e))^(c[d/32+1|0]>>>e)}else{b=c[d/32|0]>>>e}return b&((1<<f)-1)},concat:function(c,a){if(c.length===0||a.length===0){return c.concat(a)}var d=c[c.length-1],b=sjcl.bitArray.getPartial(d);if(b===32){return c.concat(a)}else{return sjcl.bitArray._shiftRight(a,b,d|0,c.slice(0,c.length-1))}},bitLength:function(d){var c=d.length,b;if(c===0){return 0}b=d[c-1];return(c-1)*32+sjcl.bitArray.getPartial(b)},clamp:function(d,b){if(d.length*32<b){return d}d=d.slice(0,Math.ceil(b/32));var c=d.length;b=b&31;if(c>0&&b){d[c-1]=sjcl.bitArray.partial(b,d[c-1]&2147483648>>(b-1),1)}return d},partial:function(b,a,c){if(b===32){return a}return(c?a|0:a<<(32-b))+b*0x10000000000},getPartial:function(a){return Math.round(a/0x10000000000)||32},equal:function(e,d){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(d)){return false}var c=0,f;for(f=0;f<e.length;f++){c|=e[f]^d[f]}return(c===0)},_shiftRight:function(d,c,h,f){var g,b=0,e;if(f===undefined){f=[]}for(;c>=32;c-=32){f.push(h);h=0}if(c===0){return f.concat(d)}for(g=0;g<d.length;g++){f.push(h|d[g]>>>c);h=d[g]<<(32-c)}b=d.length?d[d.length-1]:0;e=sjcl.bitArray.getPartial(b);f.push(sjcl.bitArray.partial(c+e&31,(c+e>32)?h:f.pop(),1));return f},_xor4:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]},byteswapM:function(c){var e,d,b=0xff00;for(e=0;e<c.length;++e){d=c[e];c[e]=(d>>>24)|((d>>>8)&b)|((d&b)<<8)|(d<<24)}return c}};sjcl.codec.utf8String={fromBits:function(a){var b="",e=sjcl.bitArray.bitLength(a),d,c;for(d=0;d<e/8;d++){if((d&3)===0){c=a[d/4]}b+=String.fromCharCode(c>>>8>>>8>>>8);c<<=8}return decodeURIComponent(escape(b))},toBits:function(d){d=unescape(encodeURIComponent(d));var a=[],c,b=0;for(c=0;c<d.length;c++){b=b<<8|d.charCodeAt(c);if((c&3)===3){a.push(b);b=0}}if(c&3){a.push(sjcl.bitArray.partial(8*(c&3),b))}return a}};sjcl.codec.hex={fromBits:function(a){var b="",c;for(c=0;c<a.length;c++){b+=((a[c]|0)+0xf00000000000).toString(16).substr(4)}return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(d){var c,b=[],a;d=d.replace(/\s|0x/g,"");a=d.length;d=d+"00000000";for(c=0;c<d.length;c+=8){b.push(parseInt(d.substr(c,8),16)^0)}return sjcl.bitArray.clamp(b,a*4)}};sjcl.codec.base32={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",_hexChars:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(h,n,g){var l=sjcl.codec.base32.BITS,a=sjcl.codec.base32.BASE,j=sjcl.codec.base32.REMAINING;var d="",f,m=0,k=sjcl.codec.base32._chars,e=0,b=sjcl.bitArray.bitLength(h);if(g){k=sjcl.codec.base32._hexChars}for(f=0;d.length*a<b;){d+=k.charAt((e^h[f]>>>m)>>>j);if(m<a){e=h[f]<<(a-m);m+=j;f++}else{e<<=a;m-=a}}while((d.length&7)&&!n){d+="="}return d},toBits:function(l,g){l=l.replace(/\s|=/g,"").toUpperCase();var o=sjcl.codec.base32.BITS,a=sjcl.codec.base32.BASE,j=sjcl.codec.base32.REMAINING;var b=[],f,p=0,k=sjcl.codec.base32._chars,d=0,m,n="base32";if(g){k=sjcl.codec.base32._hexChars;n="base32hex"}for(f=0;f<l.length;f++){m=k.indexOf(l.charAt(f));if(m<0){if(!g){try{return sjcl.codec.base32hex.toBits(l)}catch(h){}}throw new sjcl.exception.invalid("this isn't "+n+"!")}if(p>j){p-=j;b.push(d^m>>>p);d=m<<(o-p)}else{p+=a;d^=m<<(o-p)}}if(p&56){b.push(sjcl.bitArray.partial(p&56,d,1))}return b}};sjcl.codec.base32hex={fromBits:function(a,b){return sjcl.codec.base32.fromBits(a,b,1)},toBits:function(a){return sjcl.codec.base32.toBits(a,1)}};sjcl.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(g,k,b){var d="",e,j=0,h=sjcl.codec.base64._chars,f=0,a=sjcl.bitArray.bitLength(g);if(b){h=h.substr(0,62)+"-_"}for(e=0;d.length*6<a;){d+=h.charAt((f^g[e]>>>j)>>>26);if(j<6){f=g[e]<<(6-j);j+=26;e++}else{f<<=6;j-=6}}while((d.length&3)&&!k){d+="="}return d},toBits:function(h,f){h=h.replace(/\s|=/g,"");var d=[],e,g=0,j=sjcl.codec.base64._chars,b=0,a;if(f){j=j.substr(0,62)+"-_"}for(e=0;e<h.length;e++){a=j.indexOf(h.charAt(e));if(a<0){throw new sjcl.exception.invalid("this isn't base64!")}if(g>26){g-=26;d.push(b^a>>>g);b=a<<(32-g)}else{g+=6;b^=a<<(32-g)}}if(g&56){d.push(sjcl.bitArray.partial(g&56,b,1))}return d}};sjcl.codec.base64url={fromBits:function(a){return sjcl.codec.base64.fromBits(a,1,1)},toBits:function(a){return sjcl.codec.base64.toBits(a,1)}};sjcl.codec.bytes={fromBits:function(a){var b=[],e=sjcl.bitArray.bitLength(a),d,c;for(d=0;d<e/8;d++){if((d&3)===0){c=a[d/4]}b.push(c>>>24);c<<=8}return b},toBits:function(a){var b=[],d,c=0;for(d=0;d<a.length;d++){c=c<<8|a[d];if((d&3)===3){b.push(c);c=0}}if(d&3){b.push(sjcl.bitArray.partial(8*(d&3),c))}return b}};sjcl.hash.sha256=function(a){if(!this._key[0]){this._precompute()}if(a){this._h=a._h.slice(0);this._buffer=a._buffer.slice(0);this._length=a._length}else{this.reset()}};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256()).update(a).finalize()};sjcl.hash.sha256.prototype={blockSize:512,reset:function(){this._h=this._init.slice(0);this._buffer=[];this._length=0;return this},update:function(h){if(typeof h==="string"){h=sjcl.codec.utf8String.toBits(h)}var g,a=this._buffer=sjcl.bitArray.concat(this._buffer,h),f=this._length,d=this._length=f+sjcl.bitArray.bitLength(h);if(d>0x1fffffffffffff){throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits")}if(typeof Uint32Array!=="undefined"){var k=new Uint32Array(a);var e=0;for(g=512+f-((512+f)&0x1ff);g<=d;g+=512){this._block(k.subarray(16*e,16*(e+1)));e+=1}a.splice(0,16*e)}else{for(g=512+f-((512+f)&0x1ff);g<=d;g+=512){this._block(a.splice(0,16))}}return this},finalize:function(){var c,a=this._buffer,d=this._h;a=sjcl.bitArray.concat(a,[sjcl.bitArray.partial(1,1)]);for(c=a.length+2;c&15;c++){a.push(0)}a.push(Math.floor(this._length/0x100000000));a.push(this._length|0);while(a.length){this._block(a.splice(0,16))}this.reset();return d},_init:[],_key:[],_precompute:function(){var d=0,c=2,b,e;function a(f){return(f-Math.floor(f))*0x100000000|0}for(;d<64;c++){e=true;for(b=2;b*b<=c;b++){if(c%b===0){e=false;break}}if(e){if(d<8){this._init[d]=a(Math.pow(c,1/2))}this._key[d]=a(Math.pow(c,1/3));d++}}},_block:function(t){var e,f,s,r,j=this._h,c=this._key,q=j[0],p=j[1],o=j[2],n=j[3],m=j[4],l=j[5],g=j[6],d=j[7];for(e=0;e<64;e++){if(e<16){f=t[e]}else{s=t[(e+1)&15];r=t[(e+14)&15];f=t[e&15]=((s>>>7^s>>>18^s>>>3^s<<25^s<<14)+(r>>>17^r>>>19^r>>>10^r<<15^r<<13)+t[e&15]+t[(e+9)&15])|0}f=(f+d+(m>>>6^m>>>11^m>>>25^m<<26^m<<21^m<<7)+(g^m&(l^g))+c[e]);d=g;g=l;l=m;m=n+f|0;n=o;o=p;p=q;q=(f+((p&o)^(n&(p^o)))+(p>>>2^p>>>13^p>>>22^p<<30^p<<19^p<<10))|0}j[0]=j[0]+q|0;j[1]=j[1]+p|0;j[2]=j[2]+o|0;j[3]=j[3]+n|0;j[4]=j[4]+m|0;j[5]=j[5]+l|0;j[6]=j[6]+g|0;j[7]=j[7]+d|0}};sjcl.hash.sha1=function(a){if(a){this._h=a._h.slice(0);this._buffer=a._buffer.slice(0);this._length=a._length}else{this.reset()}};sjcl.hash.sha1.hash=function(a){return(new sjcl.hash.sha1()).update(a).finalize()};sjcl.hash.sha1.prototype={blockSize:512,reset:function(){this._h=this._init.slice(0);this._buffer=[];this._length=0;return this},update:function(h){if(typeof h==="string"){h=sjcl.codec.utf8String.toBits(h)}var g,a=this._buffer=sjcl.bitArray.concat(this._buffer,h),f=this._length,d=this._length=f+sjcl.bitArray.bitLength(h);if(d>0x1fffffffffffff){throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits")}if(typeof Uint32Array!=="undefined"){var k=new Uint32Array(a);var e=0;for(g=this.blockSize+f-((this.blockSize+f)&(this.blockSize-1));g<=d;g+=this.blockSize){this._block(k.subarray(16*e,16*(e+1)));e+=1}a.splice(0,16*e)}else{for(g=this.blockSize+f-((this.blockSize+f)&(this.blockSize-1));g<=d;g+=this.blockSize){this._block(a.splice(0,16))}}return this},finalize:function(){var c,a=this._buffer,d=this._h;a=sjcl.bitArray.concat(a,[sjcl.bitArray.partial(1,1)]);for(c=a.length+2;c&15;c++){a.push(0)}a.push(Math.floor(this._length/0x100000000));a.push(this._length|0);while(a.length){this._block(a.splice(0,16))}this.reset();return d},_init:[1732584193,4023233417,2562383102,271733878,3285377520],_key:[1518500249,1859775393,2400959708,3395469782],_f:function(e,a,g,f){if(e<=19){return(a&g)|(~a&f)}else{if(e<=39){return a^g^f}else{if(e<=59){return(a&g)|(a&f)|(g&f)}else{if(e<=79){return a^g^f}}}}},_S:function(b,a){return(a<<b)|(a>>>32-b)},_block:function(n){var r,g,p,o,m,l,k,i=this._h;var q;if(typeof Uint32Array!=="undefined"){q=Array(80);for(var f=0;f<16;f++){q[f]=n[f]}}else{q=n}p=i[0];o=i[1];m=i[2];l=i[3];k=i[4];for(r=0;r<=79;r++){if(r>=16){q[r]=this._S(1,q[r-3]^q[r-8]^q[r-14]^q[r-16])}g=(this._S(5,p)+this._f(r,o,m,l)+k+q[r]+this._key[Math.floor(r/20)])|0;k=l;l=m;m=this._S(30,o);o=p;p=g}i[0]=(i[0]+p)|0;i[1]=(i[1]+o)|0;i[2]=(i[2]+m)|0;i[3]=(i[3]+l)|0;i[4]=(i[4]+k)|0}};sjcl.mode.ccm={name:"ccm",_progressListeners:[],listenProgress:function(a){sjcl.mode.ccm._progressListeners.push(a)},unListenProgress:function(a){var b=sjcl.mode.ccm._progressListeners.indexOf(a);if(b>-1){sjcl.mode.ccm._progressListeners.splice(b,1)}},_callProgressListener:function(c){var b=sjcl.mode.ccm._progressListeners.slice(),a;for(a=0;a<b.length;a+=1){b[a](c)}},encrypt:function(c,b,e,j,d){var h,f=b.slice(0),k,i=sjcl.bitArray,a=i.bitLength(e)/8,g=i.bitLength(f)/8;d=d||64;j=j||[];if(a<7){throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")}for(h=2;h<4&&g>>>8*h;h++){}if(h<15-a){h=15-a}e=i.clamp(e,8*(15-h));k=sjcl.mode.ccm._computeTag(c,b,e,j,d,h);f=sjcl.mode.ccm._ctrMode(c,f,e,k,d,h);return i.concat(f.data,f.tag)},decrypt:function(b,c,e,l,d){d=d||64;l=l||[];var h,j=sjcl.bitArray,a=j.bitLength(e)/8,g=j.bitLength(c),f=j.clamp(c,g-d),k=j.bitSlice(c,g-d),i;g=(g-d)/8;if(a<7){throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")}for(h=2;h<4&&g>>>8*h;h++){}if(h<15-a){h=15-a}e=j.clamp(e,8*(15-h));f=sjcl.mode.ccm._ctrMode(b,f,e,k,d,h);i=sjcl.mode.ccm._computeTag(b,f.data,e,l,d,h);if(!j.equal(f.tag,i)){throw new sjcl.exception.corrupt("ccm: tag doesn't match")}return f.data},_macAdditionalData:function(b,m,d,c,j,k){var h,f,e,a=[],l=sjcl.bitArray,g=l._xor4;h=[l.partial(8,(m.length?1<<6:0)|(c-2)<<2|k-1)];h=l.concat(h,d);h[3]|=j;h=b.encrypt(h);if(m.length){f=l.bitLength(m)/8;if(f<=65279){a=[l.partial(16,f)]}else{if(f<=0xffffffff){a=l.concat([l.partial(16,65534)],[f])}}a=l.concat(a,m);for(e=0;e<a.length;e+=4){h=b.encrypt(g(h,a.slice(e,e+4).concat([0,0,0])))}}return h},_computeTag:function(b,a,d,k,c,h){var g,e,j=sjcl.bitArray,f=j._xor4;c/=8;if(c%2||c<4||c>16){throw new sjcl.exception.invalid("ccm: invalid tag length")}if(k.length>0xffffffff||a.length>0xffffffff){throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")}g=sjcl.mode.ccm._macAdditionalData(b,k,d,c,j.bitLength(a)/8,h);for(e=0;e<a.length;e+=4){g=b.encrypt(f(g,a.slice(e,e+4).concat([0,0,0])))}return j.clamp(g,c*8)},_ctrMode:function(e,k,h,s,g,q){var j,m,r=sjcl.bitArray,o=r._xor4,d,f=k.length,c=r.bitLength(k),b=f/50,a=b;d=r.concat([r.partial(8,q-1)],h).concat([0,0,0]).slice(0,4);s=r.bitSlice(o(s,e.encrypt(d)),0,g);if(!f){return{tag:s,data:[]}}for(m=0;m<f;m+=4){if(m>b){sjcl.mode.ccm._callProgressListener(m/f);b+=a}d[3]++;j=e.encrypt(d);k[m]^=j[0];k[m+1]^=j[1];k[m+2]^=j[2];k[m+3]^=j[3]}return{tag:s,data:r.clamp(k,c)}}};sjcl.mode.ocb2={name:"ocb2",encrypt:function(o,a,g,q,e,l){if(sjcl.bitArray.bitLength(g)!==128){throw new sjcl.exception.invalid("ocb iv must be 128 bits")}var h,m=sjcl.mode.ocb2._times2,n=sjcl.bitArray,j=n._xor4,k=[0,0,0,0],p=m(o.encrypt(g)),f,c,b=[],d;q=q||[];e=e||64;for(h=0;h+4<a.length;h+=4){f=a.slice(h,h+4);k=j(k,f);b=b.concat(j(p,o.encrypt(j(p,f))));p=m(p)}f=a.slice(h);c=n.bitLength(f);d=o.encrypt(j(p,[0,0,0,c]));f=n.clamp(j(f.concat([0,0,0]),d),c);k=j(k,j(f.concat([0,0,0]),d));k=o.encrypt(j(k,j(p,m(p))));if(q.length){k=j(k,l?q:sjcl.mode.ocb2.pmac(o,q))}return b.concat(n.concat(f,n.clamp(k,e)))},decrypt:function(p,d,g,r,e,m){if(sjcl.bitArray.bitLength(g)!==128){throw new sjcl.exception.invalid("ocb iv must be 128 bits")}e=e||64;var h,n=sjcl.mode.ocb2._times2,o=sjcl.bitArray,j=o._xor4,l=[0,0,0,0],q=n(p.encrypt(g)),f,b,k=sjcl.bitArray.bitLength(d)-e,a=[],c;r=r||[];for(h=0;h+4<k/32;h+=4){f=j(q,p.decrypt(j(q,d.slice(h,h+4))));l=j(l,f);a=a.concat(f);q=n(q)}b=k-h*32;c=p.encrypt(j(q,[0,0,0,b]));f=j(c,o.clamp(d.slice(h),b).concat([0,0,0]));l=j(l,f);l=p.encrypt(j(l,j(q,n(q))));if(r.length){l=j(l,m?r:sjcl.mode.ocb2.pmac(p,r))}if(!o.equal(o.clamp(l,e),o.bitSlice(d,k))){throw new sjcl.exception.corrupt("ocb: tag doesn't match")}return a.concat(o.clamp(f,b))},pmac:function(f,j){var b,e=sjcl.mode.ocb2._times2,g=sjcl.bitArray,c=g._xor4,d=[0,0,0,0],h=f.encrypt([0,0,0,0]),a;h=c(h,e(e(h)));for(b=0;b+4<j.length;b+=4){h=e(h);d=c(d,f.encrypt(c(h,j.slice(b,b+4))))}a=j.slice(b);if(g.bitLength(a)<128){h=c(h,e(h));a=g.concat(a,[2147483648|0,0,0,0])}d=c(d,a);return f.encrypt(c(e(c(h,e(h))),d))},_times2:function(a){return[a[0]<<1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^(a[0]>>>31)*135]}};sjcl.mode.gcm={name:"gcm",encrypt:function(h,g,c,e,d){var b,f=g.slice(0),a=sjcl.bitArray;d=d||128;e=e||[];b=sjcl.mode.gcm._ctrMode(true,h,f,e,c,d);return a.concat(b.data,b.tag)},decrypt:function(a,c,e,i,d){var f,g=c.slice(0),j,h=sjcl.bitArray,b=h.bitLength(g);d=d||128;i=i||[];if(d<=b){j=h.bitSlice(g,b-d);g=h.bitSlice(g,0,b-d)}else{j=g;g=[]}f=sjcl.mode.gcm._ctrMode(false,a,g,i,e,d);if(!h.equal(f.tag,j)){throw new sjcl.exception.corrupt("gcm: tag doesn't match")}return f.data},_galoisMultiply:function(k,g){var c,b,f,a,e,h,l=sjcl.bitArray,d=l._xor4;a=[0,0,0,0];e=g.slice(0);for(c=0;c<128;c++){f=(k[Math.floor(c/32)]&(1<<(31-c%32)))!==0;if(f){a=d(a,e)}h=(e[3]&1)!==0;for(b=3;b>0;b--){e[b]=(e[b]>>>1)|((e[b-1]&1)<<31)}e[0]=e[0]>>>1;if(h){e[0]=e[0]^(225<<24)}}return a},_ghash:function(c,f,e){var d,b,a=e.length;d=f.slice(0);for(b=0;b<a;b+=4){d[0]^=0xffffffff&e[b];d[1]^=0xffffffff&e[b+1];d[2]^=0xffffffff&e[b+2];d[3]^=0xffffffff&e[b+3];d=sjcl.mode.gcm._galoisMultiply(d,c)}return d},_ctrMode:function(m,k,t,q,e,a){var j,c,f,d,p,r,u,g,n,b,o,s,h=sjcl.bitArray;n=t.length;b=h.bitLength(t);o=h.bitLength(q);s=h.bitLength(e);j=k.encrypt([0,0,0,0]);if(s===96){c=e.slice(0);c=h.concat(c,[1])}else{c=sjcl.mode.gcm._ghash(j,[0,0,0,0],e);c=sjcl.mode.gcm._ghash(j,c,[0,0,Math.floor(s/0x100000000),s&0xffffffff])}f=sjcl.mode.gcm._ghash(j,[0,0,0,0],q);r=c.slice(0);u=f.slice(0);if(!m){u=sjcl.mode.gcm._ghash(j,f,t)}for(p=0;p<n;p+=4){r[3]++;d=k.encrypt(r);t[p]^=d[0];t[p+1]^=d[1];t[p+2]^=d[2];t[p+3]^=d[3]}t=h.clamp(t,b);if(m){u=sjcl.mode.gcm._ghash(j,f,t)}g=[Math.floor(o/0x100000000),o&0xffffffff,Math.floor(b/0x100000000),b&0xffffffff];u=sjcl.mode.gcm._ghash(j,u,g);d=k.encrypt(c);u[0]^=d[0];u[1]^=d[1];u[2]^=d[2];u[3]^=d[3];return{tag:h.bitSlice(u,0,a),data:t}}};sjcl.misc.hmac=function(d,e){this._hash=e=e||sjcl.hash.sha256;var c=[[],[]],b,a=e.prototype.blockSize/32;this._baseHash=[new e(),new e()];if(d.length>a){d=e.hash(d)}for(b=0;b<a;b++){c[0][b]=d[b]^909522486;c[1][b]=d[b]^1549556828}this._baseHash[0].update(c[0]);this._baseHash[1].update(c[1]);this._resultHash=new e(this._baseHash[0])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a){if(!this._updated){this.update(a);return this.digest(a)}else{throw new sjcl.exception.invalid("encrypt on already updated hmac called!")}};sjcl.misc.hmac.prototype.reset=function(){this._resultHash=new this._hash(this._baseHash[0]);this._updated=false};sjcl.misc.hmac.prototype.update=function(a){this._updated=true;this._resultHash.update(a)};sjcl.misc.hmac.prototype.digest=function(){var b=this._resultHash.finalize(),a=new (this._hash)(this._baseHash[1]).update(b).finalize();this.reset();return a};sjcl.misc.hkdf=function(k,m,c,a,g){var d,j,b,f,h,l,e=[];g=g||sjcl.hash.sha256;if(typeof a==="string"){a=sjcl.codec.utf8String.toBits(a)}if(typeof c==="string"){c=sjcl.codec.utf8String.toBits(c)}else{if(!c){c=[]}}d=new sjcl.misc.hmac(c,g);j=d.mac(k);f=sjcl.bitArray.bitLength(j);h=Math.ceil(m/f);if(h>255){throw new sjcl.exception.invalid("key bit length is too large for hkdf")}d=new sjcl.misc.hmac(j,g);l=[];for(b=1;b<=h;b++){d.update(l);d.update(a);d.update([sjcl.bitArray.partial(8,b)]);l=d.digest();e=sjcl.bitArray.concat(e,l)}return sjcl.bitArray.clamp(e,m)};sjcl.misc.pbkdf2=function(o,h,l,a,q){l=l||10000;if(a<0||l<0){throw new sjcl.exception.invalid("invalid params to pbkdf2")}if(typeof o==="string"){o=sjcl.codec.utf8String.toBits(o)}if(typeof h==="string"){h=sjcl.codec.utf8String.toBits(h)}q=q||sjcl.misc.hmac;var c=new q(o),p,n,g,f,d,e=[],m=sjcl.bitArray;for(d=1;32*e.length<(a||1);d++){p=n=c.encrypt(m.concat(h,[d]));for(g=1;g<l;g++){n=c.encrypt(n);for(f=0;f<n.length;f++){p[f]^=n[f]}}e=e.concat(p)}if(a){e=m.clamp(e,a)}return e};sjcl.prng=function(a){this._pools=[new sjcl.hash.sha256()];this._poolEntropy=[0];this._reseedCount=0;this._robins={};this._eventId=0;this._collectorIds={};this._collectorIdNext=0;this._strength=0;this._poolStrength=0;this._nextReseed=0;this._key=[0,0,0,0,0,0,0,0];this._counter=[0,0,0,0];this._cipher=undefined;this._defaultParanoia=a;this._collectorsStarted=false;this._callbacks={progress:{},seeded:{}};this._callbackI=0;this._NOT_READY=0;this._READY=1;this._REQUIRES_RESEED=2;this._MAX_WORDS_PER_BURST=0x10000;this._PARANOIA_LEVELS=[0,48,64,96,128,192,0x100,384,512,768,1024];this._MILLISECONDS_PER_RESEED=30000;this._BITS_PER_RESEED=80};sjcl.prng.prototype={randomWords:function(a,f){var b=[],d,c=this.isReady(f),e;if(c===this._NOT_READY){throw new sjcl.exception.notReady("generator isn't seeded")}else{if(c&this._REQUIRES_RESEED){this._reseedFromPools(!(c&this._READY))}}for(d=0;d<a;d+=4){if((d+1)%this._MAX_WORDS_PER_BURST===0){this._gate()}e=this._gen4words();b.push(e[0],e[1],e[2],e[3])}this._gate();return b.slice(0,a)},setDefaultParanoia:function(b,a){if(b===0&&a!=="Setting paranoia=0 will ruin your security; use it only for testing"){throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing")}this._defaultParanoia=b},addEntropy:function(e,l,a){a=a||"user";var b,f,g,j=(new Date()).valueOf(),c=this._robins[a],k=this.isReady(),d=0,h;b=this._collectorIds[a];if(b===undefined){b=this._collectorIds[a]=this._collectorIdNext++}if(c===undefined){c=this._robins[a]=0}this._robins[a]=(this._robins[a]+1)%this._pools.length;switch(typeof(e)){case"number":if(l===undefined){l=1}this._pools[c].update([b,this._eventId++,1,l,j,1,e|0]);break;case"object":h=Object.prototype.toString.call(e);if(h==="[object Uint32Array]"){g=[];for(f=0;f<e.length;f++){g.push(e[f])}e=g}else{if(h!=="[object Array]"){d=1}for(f=0;f<e.length&&!d;f++){if(typeof(e[f])!=="number"){d=1}}}if(!d){if(l===undefined){l=0;for(f=0;f<e.length;f++){g=e[f];while(g>0){l++;g=g>>>1}}}this._pools[c].update([b,this._eventId++,2,l,j,e.length].concat(e))}break;case"string":if(l===undefined){l=e.length}this._pools[c].update([b,this._eventId++,3,l,j,e.length]);this._pools[c].update(e);break;default:d=1}if(d){throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")}this._poolEntropy[c]+=l;this._poolStrength+=l;if(k===this._NOT_READY){if(this.isReady()!==this._NOT_READY){this._fireEvent("seeded",Math.max(this._strength,this._poolStrength))}this._fireEvent("progress",this.getProgress())}},isReady:function(b){var a=this._PARANOIA_LEVELS[(b!==undefined)?b:this._defaultParanoia];if(this._strength&&this._strength>=a){return(this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date()).valueOf()>this._nextReseed)?this._REQUIRES_RESEED|this._READY:this._READY}else{return(this._poolStrength>=a)?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY}},getProgress:function(b){var a=this._PARANOIA_LEVELS[b?b:this._defaultParanoia];if(this._strength>=a){return 1}else{return(this._poolStrength>a)?1:this._poolStrength/a}},startCollectors:function(){if(this._collectorsStarted){return}this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),keyboardCollector:this._bind(this._keyboardCollector),accelerometerCollector:this._bind(this._accelerometerCollector),touchCollector:this._bind(this._touchCollector)};if(window.addEventListener){window.addEventListener("load",this._eventListener.loadTimeCollector,false);window.addEventListener("mousemove",this._eventListener.mouseCollector,false);window.addEventListener("keypress",this._eventListener.keyboardCollector,false);window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,false);window.addEventListener("touchmove",this._eventListener.touchCollector,false)}else{if(document.attachEvent){document.attachEvent("onload",this._eventListener.loadTimeCollector);document.attachEvent("onmousemove",this._eventListener.mouseCollector);document.attachEvent("keypress",this._eventListener.keyboardCollector)}else{throw new sjcl.exception.bug("can't attach event")}}this._collectorsStarted=true},stopCollectors:function(){if(!this._collectorsStarted){return}if(window.removeEventListener){window.removeEventListener("load",this._eventListener.loadTimeCollector,false);window.removeEventListener("mousemove",this._eventListener.mouseCollector,false);window.removeEventListener("keypress",this._eventListener.keyboardCollector,false);window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,false);window.removeEventListener("touchmove",this._eventListener.touchCollector,false)}else{if(document.detachEvent){document.detachEvent("onload",this._eventListener.loadTimeCollector);document.detachEvent("onmousemove",this._eventListener.mouseCollector);document.detachEvent("keypress",this._eventListener.keyboardCollector)}}this._collectorsStarted=false},addEventListener:function(a,b){this._callbacks[a][this._callbackI++]=b},removeEventListener:function(e,a){var f,d,c=this._callbacks[e],b=[];for(d in c){if(c.hasOwnProperty(d)&&c[d]===a){b.push(d)}}for(f=0;f<b.length;f++){d=b[f];delete c[d]}},_bind:function(b){var a=this;return function(){b.apply(a,arguments)}},_gen4words:function(){for(var a=0;a<4;a++){this._counter[a]=this._counter[a]+1|0;if(this._counter[a]){break}}return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words());this._cipher=new sjcl.cipher.aes(this._key)},_reseed:function(b){this._key=sjcl.hash.sha256.hash(this._key.concat(b));this._cipher=new sjcl.cipher.aes(this._key);for(var a=0;a<4;a++){this._counter[a]=this._counter[a]+1|0;if(this._counter[a]){break}}},_reseedFromPools:function(c){var a=[],d=0,b;this._nextReseed=a[0]=(new Date()).valueOf()+this._MILLISECONDS_PER_RESEED;for(b=0;b<16;b++){a.push(Math.random()*0x100000000|0)}for(b=0;b<this._pools.length;b++){a=a.concat(this._pools[b].finalize());d+=this._poolEntropy[b];this._poolEntropy[b]=0;if(!c&&(this._reseedCount&(1<<b))){break}}if(this._reseedCount>=1<<this._pools.length){this._pools.push(new sjcl.hash.sha256());this._poolEntropy.push(0)}this._poolStrength-=d;if(d>this._strength){this._strength=d}this._reseedCount++;this._reseed(a)},_keyboardCollector:function(){this._addCurrentTimeToEntropy(1)},_mouseCollector:function(c){var a,d;try{a=c.x||c.clientX||c.offsetX||0;d=c.y||c.clientY||c.offsetY||0}catch(b){a=0;d=0}if(a!=0&&d!=0){this.addEntropy([a,d],2,"mouse")}this._addCurrentTimeToEntropy(0)},_touchCollector:function(b){var d=b.touches[0]||b.changedTouches[0];var a=d.pageX||d.clientX,c=d.pageY||d.clientY;this.addEntropy([a,c],1,"touch");this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(a){if(typeof window!=="undefined"&&window.performance&&typeof window.performance.now==="function"){this.addEntropy(window.performance.now(),a,"loadtime")}else{this.addEntropy((new Date()).valueOf(),a,"loadtime")}},_accelerometerCollector:function(b){var a=b.accelerationIncludingGravity.x||b.accelerationIncludingGravity.y||b.accelerationIncludingGravity.z;if(window.orientation){var c=window.orientation;if(typeof c==="number"){this.addEntropy(c,1,"accelerometer")}}if(a){this.addEntropy(a,2,"accelerometer")}this._addCurrentTimeToEntropy(0)},_fireEvent:function(d,a){var c,b=sjcl.random._callbacks[d],e=[];for(c in b){if(b.hasOwnProperty(c)){e.push(b[c])}}for(c=0;c<e.length;c++){e[c](a)}}};sjcl.random=new sjcl.prng(6);(function(){function b(){try{return require("crypto")}catch(g){return null}}try{var a,d,c;if(typeof module!=="undefined"&&module.exports&&(d=b())&&d.randomBytes){a=d.randomBytes(1024/8);a=new Uint32Array(new Uint8Array(a).buffer);sjcl.random.addEntropy(a,1024,"crypto.randomBytes")}else{if(typeof window!=="undefined"&&typeof Uint32Array!=="undefined"){c=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues){window.crypto.getRandomValues(c)}else{if(window.msCrypto&&window.msCrypto.getRandomValues){window.msCrypto.getRandomValues(c)}else{return}}sjcl.random.addEntropy(c,1024,"crypto.getRandomValues")}else{}}}catch(f){if(typeof window!=="undefined"&&window.console){console.log("There was an error collecting entropy from the browser:");console.log(f)}}}());sjcl.json={defaults:{v:1,iter:10000,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},_encrypt:function(h,b,c,f){c=c||{};f=f||{};var d=sjcl.json,a=d._add({iv:sjcl.random.randomWords(4,0)},d.defaults),e,g,i;d._add(a,c);i=a.adata;if(typeof a.salt==="string"){a.salt=sjcl.codec.base64.toBits(a.salt)}if(typeof a.iv==="string"){a.iv=sjcl.codec.base64.toBits(a.iv)}if(!sjcl.mode[a.mode]||!sjcl.cipher[a.cipher]||(typeof h==="string"&&a.iter<=100)||(a.ts!==64&&a.ts!==96&&a.ts!==128)||(a.ks!==128&&a.ks!==192&&a.ks!==0x100)||(a.iv.length<2||a.iv.length>4)){throw new sjcl.exception.invalid("json encrypt: invalid parameters")}if(typeof h==="string"){e=sjcl.misc.cachedPbkdf2(h,a);h=e.key.slice(0,a.ks/32);a.salt=e.salt}else{if(sjcl.ecc&&h instanceof sjcl.ecc.elGamal.publicKey){e=h.kem();a.kemtag=e.tag;h=e.key.slice(0,a.ks/32)}}if(typeof b==="string"){b=sjcl.codec.utf8String.toBits(b)}if(typeof i==="string"){a.adata=i=sjcl.codec.utf8String.toBits(i)}g=new sjcl.cipher[a.cipher](h);d._add(f,a);f.key=h;if(a.mode==="ccm"&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&b instanceof ArrayBuffer){a.ct=sjcl.arrayBuffer.ccm.encrypt(g,b,a.iv,i,a.ts)}else{a.ct=sjcl.mode[a.mode].encrypt(g,b,a.iv,i,a.ts)}return a},encrypt:function(b,d,f,c){var a=sjcl.json,e=a._encrypt.apply(a,arguments);return a.encode(e)},_decrypt:function(i,b,c,f){c=c||{};f=f||{};var d=sjcl.json,a=d._add(d._add(d._add({},d.defaults),b),c,true),g,e,h,k=a.adata;if(typeof a.salt==="string"){a.salt=sjcl.codec.base64.toBits(a.salt)}if(typeof a.iv==="string"){a.iv=sjcl.codec.base64.toBits(a.iv)}if(!sjcl.mode[a.mode]||!sjcl.cipher[a.cipher]||(typeof i==="string"&&a.iter<=100)||(a.ts!==64&&a.ts!==96&&a.ts!==128)||(a.ks!==128&&a.ks!==192&&a.ks!==0x100)||(!a.iv)||(a.iv.length<2||a.iv.length>4)){throw new sjcl.exception.invalid("json decrypt: invalid parameters")}if(typeof i==="string"){e=sjcl.misc.cachedPbkdf2(i,a);i=e.key.slice(0,a.ks/32);a.salt=e.salt}else{if(sjcl.ecc&&i instanceof sjcl.ecc.elGamal.secretKey){i=i.unkem(sjcl.codec.base64.toBits(a.kemtag)).slice(0,a.ks/32)}}if(typeof k==="string"){k=sjcl.codec.utf8String.toBits(k)}h=new sjcl.cipher[a.cipher](i);if(a.mode==="ccm"&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&a.ct instanceof ArrayBuffer){g=sjcl.arrayBuffer.ccm.decrypt(h,a.ct,a.iv,a.tag,k,a.ts)}else{g=sjcl.mode[a.mode].decrypt(h,a.ct,a.iv,k,a.ts)}d._add(f,a);f.key=i;if(c.raw===1){return g}else{return sjcl.codec.utf8String.fromBits(g)}},decrypt:function(b,d,e,c){var a=sjcl.json;return a._decrypt(b,a.decode(d),e,c)},encode:function(d){var c,b="{",a="";for(c in d){if(d.hasOwnProperty(c)){if(!c.match(/^[a-z0-9]+$/i)){throw new sjcl.exception.invalid("json encode: invalid property name")}b+=a+'"'+c+'":';a=",";switch(typeof d[c]){case"number":case"boolean":b+=d[c];break;case"string":b+='"'+escape(d[c])+'"';break;case"object":b+='"'+sjcl.codec.base64.fromBits(d[c],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}}return b+"}"},decode:function(f){f=f.replace(/\s/g,"");if(!f.match(/^\{.*\}$/)){throw new sjcl.exception.invalid("json decode: this isn't json!")}var c=f.replace(/^\{|\}$/g,"").split(/,/),d={},e,b;for(e=0;e<c.length;e++){if(!(b=c[e].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i))){throw new sjcl.exception.invalid("json decode: this isn't json!")}if(b[3]!=null){d[b[2]]=parseInt(b[3],10)}else{if(b[4]!=null){d[b[2]]=b[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(b[4]):unescape(b[4])}else{if(b[5]!=null){d[b[2]]=b[5]==="true"}}}}return d},_add:function(c,d,b){if(c===undefined){c={}}if(d===undefined){return c}var a;for(a in d){if(d.hasOwnProperty(a)){if(b&&c[a]!==undefined&&c[a]!==d[a]){throw new sjcl.exception.invalid("required parameter overridden")}c[a]=d[a]}}return c},_subtract:function(d,c){var a={},b;for(b in d){if(d.hasOwnProperty(b)&&d[b]!==c[b]){a[b]=d[b]}}return a},_filter:function(d,c){var a={},b;for(b=0;b<c.length;b++){if(d[c[b]]!==undefined){a[c[b]]=d[c[b]]}}return a}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc._pbkdf2Cache={};sjcl.misc.cachedPbkdf2=function(d,g){var b=sjcl.misc._pbkdf2Cache,i,f,h,e,a;g=g||{};a=g.iter||1000;f=b[d]=b[d]||{};i=f[a]=f[a]||{firstSalt:(g.salt&&g.salt.length)?g.salt.slice(0):sjcl.random.randomWords(2,0)};e=(g.salt===undefined)?i.firstSalt:g.salt;i[e]=i[e]||sjcl.misc.pbkdf2(d,e,g.iter);return{key:i[e].slice(0),salt:e.slice(0)}};if(typeof module!=="undefined"&&module.exports){module.exports=sjcl}if(typeof define==="function"){define([],function(){return sjcl})};
